source 2008 Hisil--Wong--Carter--Dawson, http://eprint.iacr.org/2008/522, Section 3.1, plus assumption Z1=1, plus standard simplification
unified
assume Z1 = 1
assume Z2 = 1
compute A = X1 X2
compute B = Y1 Y2
compute C = T1 d T2
compute E = (X1+Y1)(X2+Y2)-A-B
compute F = 1 - C
compute G = 1 + C
compute H = B - a A
compute X3 = E F
compute Y3 = G H
compute T3 = E H
compute Z3 = 1 - C^2
